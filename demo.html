<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width,initial-scale=1.0">

<title>Reel WebApp</title>

<style>

body{
margin:0;
background:black;
font-family:Arial;
overflow:hidden;
}

#reelContainer{
height:100vh;
overflow-y:scroll;
scroll-snap-type:y mandatory;
}

.reel{
height:100vh;
scroll-snap-align:start;
position:relative;
display:flex;
justify-content:center;
align-items:center;
}

video{
width:100%;
height:100%;
object-fit:cover;
}

.overlay{
position:absolute;
bottom:80px;
left:15px;
color:white;
}

.controls{
position:absolute;
right:15px;
bottom:120px;
color:white;
text-align:center;
}

.btn{
margin:12px 0;
font-size:22px;
cursor:pointer;
}

.topbar{
position:fixed;
top:0;
width:100%;
padding:12px;
text-align:center;
background:rgba(0,0,0,0.5);
color:white;
z-index:10;
}

</style>
</head>

<body>

<div class="topbar">üî• Reel WebApp</div>
<div id="reelContainer"></div>

<script>

const container =
document.getElementById("reelContainer");

/* ==========================
   LOAD JSON REELS
   ========================== */

fetch("reels.json")
.then(res => res.json())
.then(data => {

data.reels.forEach(item => {

let reel = document.createElement("div");
reel.className="reel";

let video = document.createElement("video");
video.src = item.video;
video.loop = true;
video.playsInline = true;

let overlay = document.createElement("div");
overlay.className="overlay";
overlay.innerHTML =
`<h3>${item.username}</h3>
<p>${item.caption}</p>`;

let controls = document.createElement("div");
controls.className="controls";
controls.innerHTML=`
<div class="btn">‚ù§Ô∏è</div>
<div class="btn">üí¨</div>
<div class="btn">üîó</div>
`;

reel.appendChild(video);
reel.appendChild(overlay);
reel.appendChild(controls);

container.appendChild(reel);

});

/* ==========================
   AUTO PLAY
   ========================== */

const videos =
document.querySelectorAll("video");

const observer =
new IntersectionObserver(entries=>{

entries.forEach(entry=>{

if(entry.isIntersecting){
entry.target.play();
}else{
entry.target.pause();
}

});

},{threshold:0.7});

videos.forEach(v=>{
observer.observe(v);

v.addEventListener("click",()=>{
v.paused ? v.play() : v.pause();
});

});

});

</script>

</body>
</html>