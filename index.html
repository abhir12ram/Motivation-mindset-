<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reels WebApp</title>

<style>
body{
  margin:0;
  background:black;
  overflow:hidden;
  font-family:sans-serif;
}

#reelContainer{
  height:100vh;
  width:100vw;
  overflow-y:scroll;
  scroll-snap-type:y mandatory;
}

.reel{
  height:100vh;
  width:100%;
  scroll-snap-align:start;
  position:relative;
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
}
</style>

</head>
<body>

<div id="reelContainer"></div>

<script>
const container = document.getElementById("reelContainer");

async function loadVideos() {

  const response = await fetch("videos.json");
  const data = await response.json();

  data.videos.forEach(src => {

    const reel = document.createElement("div");
    reel.className = "reel";

    const video = document.createElement("video");
    video.src = src;
    video.loop = true;
    video.muted = true;
    video.playsInline = true;

    reel.appendChild(video);
    container.appendChild(reel);
  });

  setupAutoPlay();
}

function setupAutoPlay(){

  const videos = document.querySelectorAll("video");

  const observer = new IntersectionObserver(entries=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        entry.target.play();
      }else{
        entry.target.pause();
      }
    });
  },{threshold:0.7});

  videos.forEach(video=>observer.observe(video));
}

loadVideos();
</script>

</body>
</html>
